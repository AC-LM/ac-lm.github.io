<!DOCTYPE HTML>

<html><head>
    <title>LM</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
    <link rel="icon" href="/images/Infinite.png" type="image/x-icon">
    <link rel="stylesheet" href="/assets/css/main.css"/>
</head><body class="is-preload" id="top">
        

        <div id="wrapper">
<header id="header">
    <h1><a href="/" style="font-size: 1.2em">LM' s Note</a></h1>
    <nav class="links">
        <ul>
            <li><a href="/posts" style="font-size: 0.9em"><strong>Posts</strong></a></li>
        </ul>
    </nav>
    <nav class="main">
        <ul>
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" action="/404.html">
                    <input type="text" name="query" placeholder="请输入关键字"/>
                </form>
            </li>
            <li class="menu">
                
                <a href="/posts" class="fa-bars">Post</a>
            </li>
        </ul>
    </nav>
</header>
            
<div id="main">
    <header>
            <div class="title">
                <h2 style="font-size:2em"><a href="javascript:void(0)">Python(1)——Selenium库</a></h2>
                <p>@LM | 2020-06-22</p>
            </div>
        </header>
        <div class="content">
            <h2 id="1什么selenium">1.什么Selenium</h2>
<p>Selenium是一个用于测试网站的自动化测试工具，支持各种浏览器，如Chrome、Firefox、Edge等。</p>
<h2 id="2安装">2.安装</h2>
<pre tabindex="0"><code>pip install Selenium
</code></pre><h2 id="3使用前提">3.使用前提</h2>
<p>Selenium的使用是基于浏览器驱动webdriver来启动与操作网页的，因此想要正常的进行Selenium自动化测试就必须获取对应浏览器的webdriver驱动文件。同时在环境变量中配置Path的属性，令其指向放置webdriver驱动文件的文件夹，或在程序中指定webdriver驱动文件的位置</p>
<h2 id="4selenium的定位方法">4.Selenium的定位方法</h2>
<pre tabindex="0"><code>|元素               | 定位一个元素                       | 含义                 
|-------------------| --------------------------------- | -------------------
|id                 | find_element_by_id                | 通过元素id定位        
|name               | find_element_by_name              | 通过元素name定位      
|xpath              | find_element_by_xpath             | 通过xpath表达式定位  
|link_texr          | find_element_by_link_text         | 通过完整超链接定位   
|partial_link_text  | find_element_by_partial_link_text | 通过部分链接定位      
|tag_name           | find_element_by_tag_name          | 通过标签定位          
|class_name         | find_element_by_class_name        | 通过类名进行定位      
|css_selector       | find_elements_by_css_selector     | 通过css选择器进行定位 
</code></pre><p>对象的定位是自动化测试的核心，要想操作一个对象，首先应该识别这个对象。一个对象就像一个人一样，他会有各种的特征（属性），我们可以通过这个属性找到这对象。以百度搜索的输入框为例，有以下属性（F12查看）</p>
<pre tabindex="0"><code>input id=&quot;kw&quot; class=&quot;s_ipt&quot; name=&quot;wd&quot; value=&quot;&quot; maxlength=&quot;255&quot; autocomplete=&quot;off&quot;
</code></pre><p>我们可以这样来定位属性（这里请注意CSS和xpath，本文中不做深入探讨，但是最常用的定位方式）</p>
<pre tabindex="0"><code>通过id方式定位：browser.find_element_by_id(&quot;kw&quot;)
通过name方式定位：browser.find_element_by_name(&quot;wd&quot;)
通过tag name方式定位：browser.find_element_by_tag_name(&quot;input&quot;)
通过class name 方式定位：browser.find_element_by_class_name(&quot;s_ipt&quot;)
通过CSS方式定位：
browser.find_element_by_css_selector(&quot;#kw&quot;)
browser.find_element_by_css_selector(&quot;html &gt; body &gt; form &gt; span &gt; input&quot;)
通过xpath方式定位：
browser.find_element_by_xpath(&quot;//input[@id='kw']&quot;)
browser.find_element_by_xpath(&quot;/html/body/form/span/input&quot;)
</code></pre><p>复数元素的定位，只要在find_element后面加上s便可，返回的是元素的列表</p>
<pre tabindex="0"><code>elements = driver.find_elements_by_xpath('//div/h3/a')
</code></pre><h2 id="5浏览器的操控">5.浏览器的操控</h2>
<pre tabindex="0"><code>| 方法                | 说明                  
| ------------------- | ----------------------
| set_window_size()   | 设置浏览器的大小       
| back()              | 控制浏览器后退         
| forward()           | 控制浏览器前进         
| refresh()           | 刷新当前页面           
| clear()             | 清除文本               
| send_keys (value)   | 模拟按键输入           
| click()             | 单击元素               
| submit()            | 用于提交表单           
| get_attribute(name) | 获取元素属性值         
| is_displayed()      | 设置该元素是否用户可见 
| size                | 返回元素的尺寸         
| text                | 获取元素的文本         
</code></pre><p>使用举例</p>
<pre tabindex="0"><code>from selenium import webdriver
#1.创建浏览器对象
browser = webdriver.Edge(executable_path =&quot;D:\GeckoDriver\edgedriver_win64\msedgedriver&quot;)
#2.通过浏览器向服务器发送URL请求
browser.get(&quot;https://www.baidu.com/&quot;)
#3.刷新浏览器
browser.refresh()
#4.设置浏览器的大小
browser.set_window_size(1400,800)
#5.设置链接内容
element=browser.find_element_by_link_text(&quot;新闻&quot;)
element.click()
</code></pre><h2 id="6模拟鼠标操作">6.模拟鼠标操作</h2>
<pre tabindex="0"><code>| 方法                   | 说明                                                         
| ---------------------- | ------------------------------------------------------------ 
| ActionChains(driver)   | 构造ActionChains对象                                         
| context_click()        | 右击                                                         
| move_to_element(above) | 执行鼠标悬停操作                                             
| double_click()         | 双击                                                         
| drag_and_drop()        | 拖动                                                         
| move_to_element(above) | 执行鼠标悬停操作                                             
| context_click()        | 用于模拟鼠标右键操作， 在调用时需要指定元素定位              
| perform()              | 执行所有 ActionChains 中存储的行为，可以理解成是对整个操作的提交动作 
</code></pre><p>使用举例</p>
<pre tabindex="0"><code>from selenium import webdriver
#1.引入 ActionChains 类
from selenium.webdriver.common.action_chains import ActionChains
driver = webdriver.Edge(executable_path =&quot;D:\GeckoDriver\edgedriver_win64\msedgedriver&quot;)
driver.get(&quot;https://www.baidu.com&quot;)
#2.定位到要悬停的元素
element= driver.find_element_by_link_text(&quot;设置&quot;)
#3.对定位到的元素执行鼠标悬停操作
ActionChains(driver).move_to_element(element).perform()
#寻找链接
elem1=driver.find_element_by_link_text(&quot;搜索设置&quot;)
elem1.click()
</code></pre><h2 id="7模拟键盘操作">7.模拟键盘操作</h2>
<pre tabindex="0"><code>| 模拟键盘按键               | 说明                
| -------------------------- | ------------------- 
| send_keys(Keys.BACK_SPACE) | 删除键（BackSpace） 
| send_keys(Keys.SPACE)      | 空格键(Space)       
| send_keys(Keys.TAB)        | 制表键(Tab)         
| send_keys(Keys.ESCAPE)     | 回退键（Esc）       
| send_keys(Keys.ENTER)      | 回车键（Enter）     
| send_keys(Keys.CONTROL,‘a’) | 全选（Ctrl+A） 
| send_keys(Keys.CONTROL,‘c’) | 复制（Ctrl+C） 
| send_keys(Keys.CONTROL,‘x’) | 剪切（Ctrl+X） 
| send_keys(Keys.CONTROL,‘v’) | 粘贴（Ctrl+V） 
| send_keys(Keys.F1…Fn)       | 键盘 F1…Fn     
</code></pre><p>使用举例</p>
<pre tabindex="0"><code>from selenium import webdriver
from selenium.webdriver.common.keys import Keys
browser = webdriver.Edge(executable_path =&quot;D:\GeckoDriver\edgedriver_win64\msedgedriver&quot;)
browser.get(&quot;https://www.baidu.com&quot;)
elem=browser.find_element_by_id(&quot;kw&quot;)
elem.send_keys('Selenium')
elem.send_keys(Keys.ENTER)
</code></pre><h2 id="8断言">8.断言</h2>
<p>我们可以采用以下属性作为断言参考</p>
<pre tabindex="0"><code>| 属性        | 说明                   
| ----------- | ----------------------
| title       | 用于获得当前页面的标题 
| current_url | 用户获得当前页面的URL  
| text        | 获取搜索条目的文本信息 
</code></pre><p>使用举例</p>
<pre tabindex="0"><code>title = driver.title
</code></pre><h2 id="9等待">9.等待</h2>
<h3 id="1强制等待强制等待sleep--from-time-import-sleep">1.强制等待：强制等待sleep()  【from time import sleep】</h3>
<p>这种强制等待，无论浏览器是否加载完成，程序都要等待，等待时间够了才继续执行下面的代码，可以作为调试时候使用，但是过于死板，可能会影响程序执行速度</p>
<h3 id="2隐性等待implicity_wait">2.隐性等待：implicity_wait()</h3>
<pre tabindex="0"><code>driver.implicitly_wait(30)  # 隐性等待，最长等30秒
</code></pre><p>隐性等待设置了一个最长等待时间，如果在规定时间内页面加载完成，则执行下一步，否则一直等到时间截止，然后执行下一步， 弊端：程序会一直等待整个页面加载完成，就是一般情况下你看到浏览器标签栏那个小圈不再转，才会执行下一步，但有时候页面想要的元素早就在加载完成了，但是因为个别js之类的东西特别慢，我仍得等到页面全部完成才能执行,这时需要显性等待</p>
<h3 id="3显性等待webdriverwait">3.显性等待：WebDriverWait()</h3>
<pre tabindex="0"><code>from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
element = WebDriverWait(driver, 5, 0.5).until(EC.presence_of_element_located((By.ID, &quot;kw&quot;)
# WebDriverWait(driver, 超时时长, 调用频率, 忽略异常).until(可执行方法, 超时时返回的信息)
</code></pre><p>需要配合该类的until()和until_not()方法，主要意思是：程序每隔xx秒看一眼，如果条件成立了，则执行下一步，否则继续等待，直到超过设置的最长时间，然后抛出TimeoutException。</p>
<h2 id="10其他方法">10.其他方法</h2>
<h3 id="a多表单切换">a.多表单切换</h3>
<pre tabindex="0"><code>| 方法                        | 说明                                              
| --------------------------- | -------------------------------------------------- 
| switch_to.frame()           | 将当前定位的主体切换为frame/iframe表单的内嵌页面中
| switch_to.default_content() | 跳回最外层的页面                               
</code></pre><h3 id="b多窗口切换">b.多窗口切换</h3>
<pre tabindex="0"><code>| 方法                  | 说明                                                         
| --------------------- | ------------------------------------------------------------ 
| current_window_handle | 获得当前窗口句柄                                             
| window_handles        | 返回所有窗口的句柄到当前会话                                
| switch_to.window()    | 用于切换到相应的窗口
</code></pre><h3 id="c警告框处理">c.警告框处理</h3>
<pre tabindex="0"><code>| 方法                  | 说明                                               
| --------------------- | -------------------------------------------------- 
| text                  | 返回 alert/confirm/prompt 中的文字信息             
| accept()              | 接受现有警告框                                     
| dismiss()             | 解散现有警告框                                     
| send_keys(keysToSend) | 发送文本至警告框。keysToSend：将文本发送至警告框。 
| switch_to_alert       | 切换到alert
</code></pre><h3 id="d下拉框选择操作">d.下拉框选择操作</h3>
<pre tabindex="0"><code>from selenium.webdriver.support.select import Select
| 方法                              | 说明                      
| --------------------------------- | ------------------------- 
| select_by_value(“选择值”)         | select标签的value属性的值 
| select_by_index(“索引值”)         | 下拉框的索引              
| select_by_visible_testx(“文本值”) | 下拉框的文本值           
</code></pre><h3 id="e文件上传">e.文件上传</h3>
<p>通过send_keys()指定本地文件路径的方式实现文件上传</p>
<h3 id="fcookie操作">f.cookie操作</h3>
<pre tabindex="0"><code>| 方法                              | 说明                                                       
| --------------------------------- | ----------------------------------------------------------
| get_cookies()                     | 获得所有cookie信息                                           
| get_cookie(name)                  | 返回字典的key为“name”的cookie信息                            
| add_cookie(cookie_dict)           | 添加cookie。“cookie_dict”指字典对象，必须有name 和value 值   
| delete_cookie(name,optionsString) | 删除cookie信息。“name”是要删除的cookie的名称，“optionsString”是该cookie的选项
| delete_all_cookies()              | 删除所有cookie信息                                           
</code></pre><h3 id="g窗口截图">g.窗口截图</h3>
<pre tabindex="0"><code>| 方法                                   | 说明                                
| -------------------------------------- | ------------------------------------ 
| get_screenshot_as_file(self, filename) | 用于截取当前窗口，并把图片保存到本地 
</code></pre><h3 id="h关闭浏览器">h.关闭浏览器</h3>
<pre tabindex="0"><code>| 方法    | 说明         
| ------- | ------------ 
| close() | 关闭单个窗口 
| quit()  | 关闭所有窗口 
</code></pre><h3 id="f获取网站源码">f.获取网站源码</h3>
<pre tabindex="0"><code>| 方法    | 说明         
| ------- | ------------ 
| page_source | 获取网站源码 
</code></pre>
            <p style="margin-top:1em;"></p>
        </div>
        <footer>
            <p class="post-copyright-license" style="margin-top:1em; margin-bottom:1em">
                <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"
                                                            rel="noopener" target="_blank"><i
                    class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。
            </p>
        </footer>
    
    <ul class="actions pagination" style="margin-bottom:5px; float:right">
        <li><a href="#top" class="button large">回到顶部</a></li>
        
        
          <li><a href="https://ac-lm.github.io/posts/python/python2%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%85%A5%E5%8F%A3/" class="button large next">下一页</a></li>
        
    </ul>
</div>


        </div>
<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/browser.min.js"></script>
<script src="/assets/js/breakpoints.min.js"></script>
<script src="/assets/js/util.js"></script>
<script src="/assets/js/main.js"></script></body>
</html>
