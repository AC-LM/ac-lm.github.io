<!DOCTYPE html>
<html lang="zh-cn">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='参考原文：SQL教程 @廖雪峰 
 1.基本查询 要查询数据库表的数据，我们使用如下的SQL语句：
SELECT * FROM &amp;lt;表名&amp;gt;; 使用SELECT * FROM students时，SELECT是关键字，表示将要执行一个查询，*表示“所有列”，FROM表示将要从哪个表查询，该SQL将查询出students表的所有数据。注意：查询结果也是一个二维表，它包含列名和每一行的数据。
SELECT语句其实并不要求一定要有FROM子句：
SELECT 100&#43;200; 上述查询会直接计算出表达式的结果。虽然SELECT可以用作计算，但它并不是SQL的强项。此外，不带FROM子句的SELECT语句有一个有用的用途，就是用来判断当前到数据库的连接是否有效。许多检测工具会执行一条SELECT 1;来测试数据库连接。
2.条件查询 SELECT语句可以通过WHERE条件来设定查询条件，查询结果是满足查询条件的记录。例如，要指定条件“分数在80分或以上的学生”，写成WHERE条件就是：
SELECT * FROM students WHERE score &amp;gt;= 80; SELECT * FROM students WHERE score BETWEEN 60 AND 90 条件表达式可以用&amp;lt;条件1&amp;gt; AND &amp;lt;条件2&amp;gt;表达满足条件1并且满足条件2。例如，符合条件“分数在80分或以上”，并且还符合条件“男生”，把这两个条件写出来：
SELECT * FROM students WHERE score &amp;gt;= 80 AND gender = &amp;#39;M&amp;#39;; 第二种条件是&amp;lt;条件1&amp;gt; OR &amp;lt;条件2&amp;gt;，表示满足条件1或者满足条件2。例如，把上述AND查询的两个条件改为OR，查询结果就是“分数在80分或以上”或者“男生”，满足任意之一的条件即选出该记录：
SELECT * FROM students WHERE score &amp;gt;= 80 OR gender = &amp;#39;M&amp;#39;; 第三种条件是NOT &amp;lt;条件&amp;gt;，表示“不符合该条件”的记录。例如，写一个“不是2班的学生”这个条件:'><title>SQL—查询数据</title>

<link rel='canonical' href='https://ac-lm.github.io/posts/sql/sql%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE/'>

<link rel="stylesheet" href="/scss/style.min.fa98bf14afdac09951c5b3f15d691ead49c9487b98b0a744d758d7966dd96652.css"><meta property='og:title' content='SQL—查询数据'>
<meta property='og:description' content='参考原文：SQL教程 @廖雪峰 
 1.基本查询 要查询数据库表的数据，我们使用如下的SQL语句：
SELECT * FROM &amp;lt;表名&amp;gt;; 使用SELECT * FROM students时，SELECT是关键字，表示将要执行一个查询，*表示“所有列”，FROM表示将要从哪个表查询，该SQL将查询出students表的所有数据。注意：查询结果也是一个二维表，它包含列名和每一行的数据。
SELECT语句其实并不要求一定要有FROM子句：
SELECT 100&#43;200; 上述查询会直接计算出表达式的结果。虽然SELECT可以用作计算，但它并不是SQL的强项。此外，不带FROM子句的SELECT语句有一个有用的用途，就是用来判断当前到数据库的连接是否有效。许多检测工具会执行一条SELECT 1;来测试数据库连接。
2.条件查询 SELECT语句可以通过WHERE条件来设定查询条件，查询结果是满足查询条件的记录。例如，要指定条件“分数在80分或以上的学生”，写成WHERE条件就是：
SELECT * FROM students WHERE score &amp;gt;= 80; SELECT * FROM students WHERE score BETWEEN 60 AND 90 条件表达式可以用&amp;lt;条件1&amp;gt; AND &amp;lt;条件2&amp;gt;表达满足条件1并且满足条件2。例如，符合条件“分数在80分或以上”，并且还符合条件“男生”，把这两个条件写出来：
SELECT * FROM students WHERE score &amp;gt;= 80 AND gender = &amp;#39;M&amp;#39;; 第二种条件是&amp;lt;条件1&amp;gt; OR &amp;lt;条件2&amp;gt;，表示满足条件1或者满足条件2。例如，把上述AND查询的两个条件改为OR，查询结果就是“分数在80分或以上”或者“男生”，满足任意之一的条件即选出该记录：
SELECT * FROM students WHERE score &amp;gt;= 80 OR gender = &amp;#39;M&amp;#39;; 第三种条件是NOT &amp;lt;条件&amp;gt;，表示“不符合该条件”的记录。例如，写一个“不是2班的学生”这个条件:'>
<meta property='og:url' content='https://ac-lm.github.io/posts/sql/sql%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE/'>
<meta property='og:site_name' content='AC-LM &#39;s blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:tag' content='Mysql' /><meta property='article:published_time' content='2020-09-28T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2020-09-28T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="SQL—查询数据">
<meta name="twitter:description" content="参考原文：SQL教程 @廖雪峰 
 1.基本查询 要查询数据库表的数据，我们使用如下的SQL语句：
SELECT * FROM &amp;lt;表名&amp;gt;; 使用SELECT * FROM students时，SELECT是关键字，表示将要执行一个查询，*表示“所有列”，FROM表示将要从哪个表查询，该SQL将查询出students表的所有数据。注意：查询结果也是一个二维表，它包含列名和每一行的数据。
SELECT语句其实并不要求一定要有FROM子句：
SELECT 100&#43;200; 上述查询会直接计算出表达式的结果。虽然SELECT可以用作计算，但它并不是SQL的强项。此外，不带FROM子句的SELECT语句有一个有用的用途，就是用来判断当前到数据库的连接是否有效。许多检测工具会执行一条SELECT 1;来测试数据库连接。
2.条件查询 SELECT语句可以通过WHERE条件来设定查询条件，查询结果是满足查询条件的记录。例如，要指定条件“分数在80分或以上的学生”，写成WHERE条件就是：
SELECT * FROM students WHERE score &amp;gt;= 80; SELECT * FROM students WHERE score BETWEEN 60 AND 90 条件表达式可以用&amp;lt;条件1&amp;gt; AND &amp;lt;条件2&amp;gt;表达满足条件1并且满足条件2。例如，符合条件“分数在80分或以上”，并且还符合条件“男生”，把这两个条件写出来：
SELECT * FROM students WHERE score &amp;gt;= 80 AND gender = &amp;#39;M&amp;#39;; 第二种条件是&amp;lt;条件1&amp;gt; OR &amp;lt;条件2&amp;gt;，表示满足条件1或者满足条件2。例如，把上述AND查询的两个条件改为OR，查询结果就是“分数在80分或以上”或者“男生”，满足任意之一的条件即选出该记录：
SELECT * FROM students WHERE score &amp;gt;= 80 OR gender = &amp;#39;M&amp;#39;; 第三种条件是NOT &amp;lt;条件&amp;gt;，表示“不符合该条件”的记录。例如，写一个“不是2班的学生”这个条件:">
    <link rel="shortcut icon" href="/images/Infinite.png" />

    </head>
    <body class="
    article-page 
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "dark");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        on-phone--column extended
    
">
    
        <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu0e5bb052ec3dba437a0eff173370edc8_1029_300x0_resize_box_3.png" width="300"
                            height="273" class="site-logo" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <h1 class="site-name"><a href="/">AC-LM &#39;s blog</a></h1>
        <h2 class="site-description">(￣O￣) . Z Z Z</h2></header>

    <ol class="menu" id="main-menu" style='font-size: larger;'>
        
        
        

        <li id="menu-Back" >
            <a href='#' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                
                <span>Back</span>
            </a>
        </li>
        
        

        <li id="menu-Home" >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li id="menu-Posts" >
            <a href='/posts' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                
                <span>Posts</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>Dark Mode</span>
            </li>
        
    </ol>
</aside>

    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/posts/sql/sql%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE/">SQL—查询数据</a>
    </h2>

    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Sep 28, 2020</time>
            </div>
        

        
    </footer>
    
</div>
</header>

    <section class="article-content">
    
    
    <blockquote>
<p>参考原文：<a class="link" href="https://www.liaoxuefeng.com/wiki/1177760294764384"  target="_blank" rel="noopener"
    > SQL教程 @廖雪峰 </a></p>
</blockquote>
<h2 id="1基本查询">1.基本查询</h2>
<p>要查询数据库表的数据，我们使用如下的SQL语句：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">表名</span><span style="color:#f92672">&gt;</span>;
</code></pre></div><p>使用SELECT * FROM students时，SELECT是关键字，表示将要执行一个查询，*表示“所有列”，FROM表示将要从哪个表查询，该SQL将查询出students表的所有数据。注意：查询结果也是一个二维表，它包含列名和每一行的数据。</p>
<p>SELECT语句其实并不要求一定要有FROM子句：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> <span style="color:#ae81ff">100</span><span style="color:#f92672">+</span><span style="color:#ae81ff">200</span>;
</code></pre></div><p>上述查询会直接计算出表达式的结果。虽然SELECT可以用作计算，但它并不是SQL的强项。此外，不带FROM子句的SELECT语句有一个有用的用途，就是用来判断当前到数据库的连接是否有效。许多检测工具会执行一条SELECT 1;来测试数据库连接。</p>
<h2 id="2条件查询">2.条件查询</h2>
<p>SELECT语句可以通过WHERE条件来设定查询条件，查询结果是满足查询条件的记录。例如，要指定条件“分数在80分或以上的学生”，写成WHERE条件就是：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> students <span style="color:#66d9ef">WHERE</span> score <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">80</span>;
<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> students <span style="color:#66d9ef">WHERE</span> score <span style="color:#66d9ef">BETWEEN</span> <span style="color:#ae81ff">60</span> <span style="color:#66d9ef">AND</span> <span style="color:#ae81ff">90</span>
</code></pre></div><p>条件表达式可以用&lt;条件1&gt; AND &lt;条件2&gt;表达满足条件1并且满足条件2。例如，符合条件“分数在80分或以上”，并且还符合条件“男生”，把这两个条件写出来：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> students <span style="color:#66d9ef">WHERE</span> score <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">80</span> <span style="color:#66d9ef">AND</span> gender <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;M&#39;</span>;
</code></pre></div><p>第二种条件是&lt;条件1&gt; OR &lt;条件2&gt;，表示满足条件1或者满足条件2。例如，把上述AND查询的两个条件改为OR，查询结果就是“分数在80分或以上”或者“男生”，满足任意之一的条件即选出该记录：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> students <span style="color:#66d9ef">WHERE</span> score <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">80</span> <span style="color:#66d9ef">OR</span> gender <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;M&#39;</span>;
</code></pre></div><p>第三种条件是NOT &lt;条件&gt;，表示“不符合该条件”的记录。例如，写一个“不是2班的学生”这个条件:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> students <span style="color:#66d9ef">WHERE</span> <span style="color:#66d9ef">NOT</span> class_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;
<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> students <span style="color:#66d9ef">WHERE</span> class_id <span style="color:#f92672">&lt;&gt;</span> <span style="color:#ae81ff">2</span>;
</code></pre></div><p>要组合三个或者更多的条件，就需要用小括号()表示如何进行条件运算。例如，编写一个复杂的条件：分数在80以下或者90以上，并且是男生：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> students <span style="color:#66d9ef">WHERE</span> (score <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">80</span> <span style="color:#66d9ef">OR</span> score <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">90</span>) <span style="color:#66d9ef">AND</span> gender <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;M&#39;</span>;
</code></pre></div><p>如果不加括号，条件运算按照NOT、AND、OR的优先级进行，即NOT优先级最高，其次是AND，最后是OR。加上括号可以改变优先级。</p>
<h3 id="常用的条件表达式">常用的条件表达式</h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th style="text-align:left">条件</th>
<th style="text-align:left">表达式举例1</th>
<th style="text-align:left">表达式举例2</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">使用=判断相等</td>
<td style="text-align:left">score = 80</td>
<td style="text-align:left">name = &lsquo;abc&rsquo;</td>
<td style="text-align:left">字符串需要用单引号括起来</td>
</tr>
<tr>
<td style="text-align:left">使用&gt;判断大于</td>
<td style="text-align:left">score &gt; 80</td>
<td style="text-align:left">name &gt; &lsquo;abc&rsquo;</td>
<td style="text-align:left">字符串比较根据ASCII码，中文字符比较根据数据库设置</td>
</tr>
<tr>
<td style="text-align:left">使用&gt;=判断大于或相等</td>
<td style="text-align:left">score &gt;= 80</td>
<td style="text-align:left">name &gt;= &lsquo;abc&rsquo;</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">使用&lt;判断小于</td>
<td style="text-align:left">score &lt; 80</td>
<td style="text-align:left">name &lt;= &lsquo;abc&rsquo;</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">使用&lt;=判断小于或相等</td>
<td style="text-align:left">score &lt;= 80</td>
<td style="text-align:left">name &lt;= &lsquo;abc&rsquo;</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">使用&lt;&gt;判断不相等</td>
<td style="text-align:left">score &lt;&gt; 80</td>
<td style="text-align:left">name &lt;&gt; &lsquo;abc&rsquo;</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">使用LIKE判断相似</td>
<td style="text-align:left">name LIKE &lsquo;ab%&rsquo;</td>
<td style="text-align:left">name LIKE &lsquo;%bc%&rsquo;</td>
<td style="text-align:left">%表示任意字符，例如&rsquo;ab%&lsquo;将匹配&rsquo;ab&rsquo;，&lsquo;abc&rsquo;，&lsquo;abcd&rsquo;</td>
</tr>
</tbody>
</table></div>
<h2 id="3投影查询">3.投影查询</h2>
<p>如果我们只希望返回某些列的数据，而不是所有列的数据，我们可以用SELECT 列1, 列2, 列3 FROM &hellip;，让结果集仅包含指定列。这种操作称为投影查询</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> id, score, name <span style="color:#66d9ef">FROM</span> students;
</code></pre></div><p>使用SELECT 列1, 列2, 列3 FROM &hellip;时，还可以给每一列起个别名，这样，结果集的列名就可以与原表的列名不同。它的语法是SELECT 列1 别名1, 列2 别名2, 列3 别名3 FROM &hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> id, score points, name <span style="color:#66d9ef">FROM</span> students;
</code></pre></div><p>投影查询同样可以接WHERE条件，实现复杂的查询：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> id, score points, name <span style="color:#66d9ef">FROM</span> students <span style="color:#66d9ef">WHERE</span> gender <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;M&#39;</span>;
</code></pre></div><h2 id="4聚合查询">4.聚合查询</h2>
<p>对于统计总数、平均数这类计算，SQL提供了专门的聚合函数，使用聚合函数进行查询，就是聚合查询，它可以快速获得结果。</p>
<p>COUNT(<em>)表示查询所有列的行数，要注意聚合的计算结果虽然是一个数字，但查询的结果仍然是一个二维表，只是这个二维表只有一行一列，并且列名是COUNT(</em>)。通常，使用聚合查询时，我们应该给列名设置一个别名，便于处理结果：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">COUNT</span>(<span style="color:#f92672">*</span>) num <span style="color:#66d9ef">FROM</span> students;
<span style="color:#f92672">//</span>num <span style="color:#ae81ff">10</span>
</code></pre></div><p>COUNT(*)和COUNT(id)实际上是一样的效果。另外注意，聚合查询同样可以使用WHERE条件，因此我们可以方便地统计出有多少男生、多少女生、多少80分以上的学生等。此外要特别注意：如果聚合查询的WHERE条件没有匹配到任何行，COUNT()会返回0，而SUM()、AVG()、MAX()和MIN()会返回NULL</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">COUNT</span>(<span style="color:#f92672">*</span>) boys <span style="color:#66d9ef">FROM</span> students <span style="color:#66d9ef">WHERE</span> gender <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;M&#39;</span>;
</code></pre></div><h3 id="聚合函数">聚合函数</h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th style="text-align:left">函数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">SUM</td>
<td style="text-align:left">计算某一列的合计值，该列必须为数值类型</td>
</tr>
<tr>
<td style="text-align:left">AVG</td>
<td style="text-align:left">计算某一列的平均值，该列必须为数值类型</td>
</tr>
<tr>
<td style="text-align:left">MAX</td>
<td style="text-align:left">计算某一列的最大值</td>
</tr>
<tr>
<td style="text-align:left">MIN</td>
<td style="text-align:left">计算某一列的最小值</td>
</tr>
</tbody>
</table></div>
<h3 id="分组聚合">分组聚合</h3>
<p>对于聚合查询，SQL还提供了“分组聚合”的功能。例如，执行以下这个查询，COUNT()的结果不再是一个，而是3个，这是因为，GROUP BY子句指定了按class_id分组，因此，执行该SELECT语句时，会把class_id相同的列先分组，再分别计算，最终得到3行结果。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> class_id, <span style="color:#66d9ef">COUNT</span>(<span style="color:#f92672">*</span>) num <span style="color:#66d9ef">FROM</span> students <span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> class_id;
</code></pre></div><h2 id="5多表查询">5.多表查询</h2>
<p>SELECT查询不但可以从一张表查询数据，还可以从多张表同时查询数据。查询多张表的语法是：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">表</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">表</span><span style="color:#ae81ff">2</span><span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> students, classes;
</code></pre></div><p>这种一次查询两个表的数据，查询的结果也是一个二维表，它是students表和classes表的“乘积”，即students表的每一行与classes表的每一行都两两拼在一起返回。结果集的列数是students表和classes表的列数之和，行数是students表和classes表的行数之积。</p>
<p>这种多表查询又称笛卡尔查询，使用笛卡尔查询时要非常小心，由于结果集是目标表的行数乘积，对两个各自有100行记录的表进行笛卡尔查询将返回1万条记录，对两个各自有1万行记录的表进行笛卡尔查询将返回1亿条记录。</p>
<p>注意，多表查询时，要使用表名.列名这样的方式来引用列和设置别名，这样就避免了结果集的列名重复问题。但是，用表名.列名这种方式列举两个表的所有列实在是很麻烦，所以SQL还允许给表设置一个别名，让我们在投影查询中引用起来稍微简洁一点。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span>
    s.id sid,
    s.name,
    s.gender,
    s.score,
    <span style="color:#66d9ef">c</span>.id cid,
    <span style="color:#66d9ef">c</span>.name cname
<span style="color:#66d9ef">FROM</span> students s, classes <span style="color:#66d9ef">c</span>
<span style="color:#66d9ef">WHERE</span> s.gender <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;M&#39;</span> <span style="color:#66d9ef">AND</span> <span style="color:#66d9ef">c</span>.id <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</code></pre></div><h2 id="6连接查询">6.连接查询</h2>
<p>连接查询是另一种类型的多表查询。连接查询对多个表进行JOIN运算，简单地说，就是先确定一个主表作为结果集，然后，把其他表的行有选择性地“连接”在主表结果集上。例如，我们想要选出students表的所有学生信息，可以用一条简单的SELECT语句完成（从主表提取元素组成新表）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> s.id, s.name, s.class_id, s.gender, s.score <span style="color:#66d9ef">FROM</span> students s;
</code></pre></div><p>但是，假设我们希望结果集同时包含所在班级的名称，上面的结果集只有class_id列，缺少对应班级的name列。</p>
<p>现在问题来了，存放班级名称的name列存储在classes表中，只有根据students表的class_id，找到classes表对应的行，再取出name列，就可以获得班级名称。</p>
<p>这时，连接查询就派上了用场。我们先使用最常用的一种内连接——INNER JOIN来实现：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> s.id, s.name, s.class_id, <span style="color:#66d9ef">c</span>.name class_name, s.gender, s.score
<span style="color:#66d9ef">FROM</span> students s
<span style="color:#66d9ef">INNER</span> <span style="color:#66d9ef">JOIN</span> classes <span style="color:#66d9ef">c</span>
<span style="color:#66d9ef">ON</span> s.class_id <span style="color:#f92672">=</span> <span style="color:#66d9ef">c</span>.id;
</code></pre></div><p>注意INNER JOIN查询的写法是：</p>
<ul>
<li>先确定主表，仍然使用FROM &lt;表1&gt;的语法；</li>
<li>再确定需要连接的表，使用INNER JOIN &lt;表2&gt;的语法；</li>
<li>然后确定连接条件，使用ON &lt;条件&hellip;&gt;，这里的条件是s.class_id = c.id，表示students表的class_id列与classes表的id列相同的行需要连接；</li>
<li>可选：加上WHERE子句、ORDER BY等子句。</li>
</ul>
<h3 id="连接方式">连接方式</h3>
<ul>
<li>INNER JOIN只返回同时存在于两张表的行数据，由于students表的class_id包含1，2，3，classes表的id包含1，2，3，4，所以，INNER JOIN根据条件s.class_id = c.id返回的结果集仅包含1，2，3。</li>
<li>RIGHT OUTER JOIN返回右表都存在的行。如果某一行仅在右表存在，那么结果集就会以NULL填充剩下的字段。</li>
<li>LEFT OUTER JOIN则返回左表都存在的行。如果我们给students表增加一行，并添加class_id=5，由于classes表并不存在id=5的行，所以，LEFT OUTER JOIN的结果会增加一行，对应的class_name是NULL：</li>
<li>FULL OUTER JOIN，它会把两张表的所有记录全部选择出来，并且，自动把对方不存在的列填充为NULL</li>
</ul>
<h2 id="7排序">7.排序</h2>
<p>我们使用ORDER BY语句进行排序</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> id, name, gender, score <span style="color:#66d9ef">FROM</span> students <span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> score;
</code></pre></div><p>我们可以加上DESC表示“倒序”</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> id, name, gender, score <span style="color:#66d9ef">FROM</span> students <span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> score <span style="color:#66d9ef">DESC</span>;
</code></pre></div><p>如果score列有相同的数据，要进一步排序，可以继续添加列名。例如，使用ORDER BY score DESC, gender表示先按score列倒序，如果有相同分数的，再按gender列排序：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> id, name, gender, score <span style="color:#66d9ef">FROM</span> students <span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> score <span style="color:#66d9ef">DESC</span>, gender;
</code></pre></div><p>默认的排序规则是ASC：“升序”，即从小到大。ASC可以省略，即ORDER BY score ASC和ORDER BY score效果一样。</p>
<p>如果有WHERE子句，那么ORDER BY子句要放到WHERE子句后面。例如，查询一班的学生成绩，并按照倒序排序：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> id, name, gender, score
<span style="color:#66d9ef">FROM</span> students
<span style="color:#66d9ef">WHERE</span> class_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
<span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> score <span style="color:#66d9ef">DESC</span>;
</code></pre></div><h2 id="8分页">8.分页</h2>
<p>分页实际上就是从结果集中“截取”出第M~N条记录。这个查询可以通过LIMIT M OFFSET N子句实现</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> id, name, gender, score
<span style="color:#66d9ef">FROM</span> students
<span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> score <span style="color:#66d9ef">DESC</span>
<span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">3</span> <span style="color:#66d9ef">OFFSET</span> <span style="color:#ae81ff">0</span>;
</code></pre></div><p>上述查询LIMIT 3 OFFSET 0表示，对结果集从0号记录开始，最多取3条。注意SQL记录集的索引从0开始</p>
<p>如果要查询第2页，那么我们只需要“跳过”头3条记录，也就是对结果集从3号记录开始查询，把OFFSET设定为3：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> id, name, gender, score
<span style="color:#66d9ef">FROM</span> students
<span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> score <span style="color:#66d9ef">DESC</span>
<span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">3</span> <span style="color:#66d9ef">OFFSET</span> <span style="color:#ae81ff">3</span>;
</code></pre></div><p>注意</p>
<ul>
<li>OFFSET超过了查询的最大数量并不会报错，而是得到一个空的结果集。</li>
<li>OFFSET是可选的，如果只写LIMIT 15，那么相当于LIMIT 15 OFFSET 0。</li>
<li>在MySQL中，LIMIT 15 OFFSET 30还可以简写成LIMIT 30, 15。</li>
<li>使用LIMIT M OFFSET N 分页时，随着N越来越大，查询效率也会越来越低。</li>
</ul>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/mysql/">Mysql</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="">
    <a href="/posts/sql/sql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E8%A8%80/">
        
        

        <div class="article-details">
            <h2 class="article-title">SQL—数据库语言</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2022 AC-LM &#39;s blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.7.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    

            </main>
    

        </div>
        <script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
