<!DOCTYPE HTML>

<html><head>
    <title>LM</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
    <link rel="icon" href="/images/Infinite.png" type="image/x-icon">
    <link rel="stylesheet" href="/assets/css/main.css"/>
</head><body class="is-preload" id="top">
        

        <div id="wrapper">
<header id="header">
    <h1><a href="/" style="font-size: 1.2em">LM' s Note</a></h1>
    <nav class="links">
        <ul>
            <li><a href="/posts" style="font-size: 0.9em"><strong>Posts</strong></a></li>
        </ul>
    </nav>
    <nav class="main">
        <ul>
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="#">
                    <input type="text" name="query" placeholder="施工中" disabled="disabled"/>
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>
<section id="menu">
    
    <section>
        <h2>施工中</h2>
    </section>
</section>
<div id="main">
    <header>
            <div class="title">
                <h2 style="font-size:2em"><a href="javascript:void(0)">Python(30)——import</a></h2>
                <p>@LM | 2021-06-03</p>
            </div>
        </header>
        <div class="content">
            <blockquote>
<p>参考：<a href="https://zhuanlan.zhihu.com/p/63143493"> Python中import的用法  @门书生 </a> &amp;  <a href="https://zhuanlan.zhihu.com/p/348559778"> 聊聊Python Import System？@没有50CM手臂 </a></p>
</blockquote>
<h2 id="a基本概念">A.基本概念</h2>
<h3 id="1-什么可以被import">1. 什么可以被import？</h3>
<p>这个问题不难回答，因为Python中一切都是对象，都是属于object，所以任何东西都是可以被import的，在这些不同的对象中，我们经常使用到的是模块（Module） 和 包（Package） 这两个概念。虽然表面上它们是两个概念，但是在Python的底层都是一个PyModuleObject结构体实例，类型为PyModule_Type，而在Python中则都是表现为一个&lt;class &lsquo;module&rsquo;&gt;对象。</p>
<h4 id="11-模块module">1.1 模块（Module）</h4>
<p>Python中，不管是对常见的.py文件，或是编译优化的.pyc, .pyo文件、扩展类型的.pyd，.pyw文件来说， 它们是属于Python代码载体的最小单元，这样单独存在的文件我们都称之为“模块”。</p>
<h4 id="12-包package">1.2 包（Package）</h4>
<p>上述这样的多个模块组合在一起，我们就称之为“包”。通常来说，创建包的步骤都是这样的：首先新建目录A、然后新建<code>__init__.py</code>，最后再编写模块。这种包被称为：“Regular packages”，事实上，在<a href="https://link.zhihu.com/?target=https%3A//www.python.org/dev/peps/pep-0420/">PEP 420 &ndash; Implicit Namespace Packages</a>中提到，从Python3.3版本开始引入了“Namespace Packages”这个新的包类型。碍于篇幅有限，在这便不展开介绍。</p>
<h3 id="2-import的方式---绝对导入相对导入">2. import的方式？&ndash; 绝对导入/相对导入</h3>
<h4 id="21-绝对导入">2.1 绝对导入</h4>
<p>绝对路径要求我们必须从最顶层的文件夹开始，为每个包或每个模块提供出完整详细的导入路径</p>
<pre><code>from package1 import mudule1
from package1.module2 import Fx
from package2 import Cx
from package2.subpackage1.module5 import Fy
</code></pre><h4 id="22-相对导入">2.2 相对导入</h4>
<p>当我们使用相对导入时，需要给出相对与当前位置，想导入资源所在的位置。</p>
<p>相对导入分为“隐式相对导入”和“显式相对导入”两种，比如我们想在package2/module3.py中引用module4模块，我们可以这么写</p>
<pre><code># package2/module3.py

import module4 # 隐式相对导入，被淘汰
from . import module4 # 显式相对导入
from package2 import module4 # 绝对导入
</code></pre><p>代码中<code>.</code>表示当前文件所在的目录，如果是<code>..</code>就表示该目录的上一层目录，三个<code>.</code>、四个<code>.</code>依次类推。可以看出，隐式相对导入相比于显式相对导入无非就是隐含了当前目录这个条件，不过这样会容易引起混乱，所以在<a href="https://link.zhihu.com/?target=https%3A//www.python.org/dev/peps/pep-0328/">PEP 328</a>的时候被正式淘汰，毕竟“<strong>Explicit is better than implicit</strong>”。</p>
<p>注意在跨多个文件导入包时，需注意相对导入寻找相对位置的算法是基于<code>__name__</code>和<code>__package__</code>变量的值。大部分时候，这些变量不包含任何包信息。比如：当<code>__name__=__main__,__package__=None</code>时，Python解释器不知道模块所属的包。在这种情况下，相对引用会认为这个模块就是顶级模块，而不管模块在文件系统上的实际位置。</p>
<h2 id="bimport的机制">B.import的机制</h2>
<p>调用关键字<code>import</code>的时候主要会触发两个操作：<strong>搜索</strong>和<strong>加载</strong>（也可以理解为搜索模块在哪里和把找到的模块加载到某个地方）</p>
<h3 id="1-搜索">1 搜索</h3>
<p>Python会在两个地方寻找这个模块，第一是sys.path（通过运行代码import sys; print(sys.path)查看），一般安装的Python库的目录都可以在sys.path中找到（前提是要将Python的安装目录添加到电脑的环境变量）。第二个地方就是运行文件所在的目录。</p>
<h3 id="2-加载">2 加载</h3>
<h4 id="21-import">2.1 import</h4>
<pre><code>import a
print(type(a))
# &lt;class 'module'&gt;
# 加载的是一个模块对象，使用的是另一个模块的内存
# 其运行逻辑如图
</code></pre><p><img src="https://gitee.com/LM-J/drawingbed/raw/master/img/1.jpg" alt=""></p>
<h4 id="22-fromimport">2.2 from&hellip;..import&hellip;&hellip;</h4>
<pre><code>from a import zx
print(type(zx))
# &lt;class 'method'&gt;
# 加载的是方法，直接将内容复制一份，使用自己的内存
# 其运行逻辑如图
</code></pre><p><img src="https://gitee.com/LM-J/drawingbed/raw/master/img/2.jpg" alt=""></p>

        </div>
        <footer>
            <p class="post-copyright-license" style="margin-bottom:1em">
                <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"
                                                            rel="noopener" target="_blank"><i
                    class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
            </p>
        </footer>
    
    <ul class="actions pagination" style="margin-bottom:5px; float:right">
        <li><a href="#top" class="button large">回到顶部</a></li>
        
          <li><a href="https://ac-lm.github.io/posts/python/python23os%E6%A8%A1%E5%9D%97%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/" class="button large previous">上一页</a></li>
        
        
          <li><a href="https://ac-lm.github.io/posts/python/python29__init__%E6%96%87%E4%BB%B6/" class="button large next">下一页</a></li>
        
    </ul>
</div>


        </div>
<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/browser.min.js"></script>
<script src="/assets/js/breakpoints.min.js"></script>
<script src="/assets/js/util.js"></script>
<script src="/assets/js/main.js"></script></body>
</html>
